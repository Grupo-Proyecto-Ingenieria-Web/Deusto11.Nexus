{% extends "base.html" %}
{% load static %}

{% block tittle %}{{ tittle }}{% endblock %}

{% block content %}
<!--Script para el get de emails-->
<script>
    const SERVICE_URL="http://127.0.0.1:8000/nexus.com/apiallemails/"
    function loadData() {
      fetch(SERVICE_URL)
      .then((response) => response.json())
      .then((json) => {
          for (let element of json) {
            
          var dates='<td>'+element.send_user+'</td> <td>'+element.subjct+'</td>   '
          console.log(dates)
          document.getElementById("tablaemail1").insertRow(-1).innerHTML =dates
          
          }
      });
  }

      loadData();
   
</script>
<!--Script para el get de emails de contactos-->
<script>
    const SERVICE_URL="http://127.0.0.1:8000/nexus.com/apiallemployer/"
    function loadData() {
      fetch(SERVICE_URL)
      .then((response) => response.json())
      .then((json) => {
          for (let element of json) {
            
          var dates='<td>'+element.name+'</td> <td>'+element.email+'</td>   '
          console.log(dates)
          document.getElementById("tablaemail3").insertRow(-1).innerHTML =dates
          
          }
      });
  }

      loadData();

</script>
<!--Script post de ajax-->
<script>
    document.getElementById("formulario").addEventListener("submit", Crearobj)
    function Crearobj(event) {
    event.preventDefault()
       var a=new FormData(document.getElementById("formulario"))
     fetch("http://127.0.0.1:8000/nexus.com/apiallemails/", {
     method :'POST',

        body :
        a
            })
            .then(response => response.json())
            .then(json => console.log(json))
            var aviso = document.createTextNode("Se ha creado el cliente correctamente");

    p.appendChild(aviso);
    }
</script>
<div id="tabla">
    <table id="tablaemail1">
        <tr>
            <th>Person you have sent the email</th>
            <th>Subject</th>
        </tr>
    </table>

    <div id="tablaemail2">
        <tr>
            <form  id=formulario>
                {% csrf_token %}
                Person you send the email: <input id=correo type="text">
                Your email: <input type="text">
                <br><br>
                Subject: <input type="text">
                <br><br>
                Text: <br><textarea name="text" rows="20" cols="90"></textarea>
                <br><br>
                <input class="personalizar" type="submit" value="Send" />
                
        </tr>
    </div>

    <table id="tablaemail3">รง
        <tr>
            <th>Name of that contact: </th>
            <th>Email of that contact: </th>
        </tr>

    </table>

</div>

{% endblock %}
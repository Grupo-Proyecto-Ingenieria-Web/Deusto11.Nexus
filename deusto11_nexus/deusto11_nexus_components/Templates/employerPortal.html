{% extends "base.html" %} 
{% load static %} 
{% block title %}{{ title }}{% endblock %} 
{% block content %}
<!-- <script>
    const SERVICE_URL="http://127.0.0.1:8000/nexus.com/apiallmachine/"
    function loadData() {
      fetch(SERVICE_URL)
      .then((response) => response.json())
      .then((json) => {
          for (let element of json) {
            var url="http://127.0.0.1:8000/nexus.com/ticket/update/"
            url=url+element.id+"/"
            console.log(element.model);
          var dates='<td>'+element.reference_number+'</td> <td>'+element.model+'</td> <td>'+element.brand+'</td> <td>'+element.machine_type+'</td> <td>'+element.get_date+'</td> <td>'+element.start_up_date+'</td> <td>'+element.provider_name+'</td> <td>'+element.provider_telefone+'</td> <td>'+element.floor_on_premise+'</td> <td>'+url+'</td>  '
          console.log(dates)
          document.getElementById("table2").insertRow(-1).innerHTML =dates
          
          }
      });
  }

      loadData();   
</script> -->
<h1 id="titletabla">Lista de Maquinas</h1>
<div>
    <!--<a href="{% url 'ticket_registry' %}"><input class="personalizar" type="submit" value="Nuevo Ticket" /></a>-->
    <a href="{% url 'machine_registry' %}"><input class="personalizar" type="submit" value="Nuevo Equipo" /></a>
    <a href="{% url 'employer_update' logged_employer.id %}"><input class="personalizar" type="submit" value="Actualizar perfil empleado" /></a>
    <a href="{% url 'menu_default_portal' %}"><input class="personalizar" type="submit" value="Volver al inicio" /></a>
</div>
<div id="tabla">
    <table id="table2">
        <tr>
            <th>Numero de referencia de la maquina</th>
            <th>Modelo</th>
            <th>Marca</th>
            <th>Tipo de maquina</th>
            <th>Fecha apertura</th>
            <th>Fecha de puesta en marcha</th>
            <th>Nombre del proveedor</th>
            <th>Telefono del proveedor</th>
            <th>Planta</th>           
        </tr>
        {% if list_machines_already_exists %}  
            {% for machine in list_machines_already_exists %}
                <tr>
                    <td>{{ machine.set_number }}</td>
                    <td>{{ machine.model }}</td>
                    <td>{{ machine.brand }}</td>
                    <td>{{ machine.machine_type }}</td>
                    <td>{{ machine.get_date }}</td>
                    <td>{{ machine.start_up_date }}</td>
                    <td>{{ machine.provider_name}}</td>
                    <td>{{ machine.provider_telefone }}</td>
                    <td>{{ machine.floor_on_premise }}</td>
                    <td> <a href="{% url 'update_machine' machine.id %}"><input class="personalizar" type="button" value="Actualizar"></a></td>
                    <td>
                        <form action=""  method="post">   
                            {% csrf_token %}
                            <button class="personalizar" type="submit" value={{ machine.id }} name="Delete">Eliminar</button> 
                        </form>
                    </td>
                </tr>
            {% endfor %}
        {% else %}
        <tr>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <th>No data</th>
            <td> <a href="{% url 'update_machine' machine.id %}"><input type="button" value="Actualizar"></a></td>
            <td> <a href="{% url 'employer_create' %}"><input type="button" value="Registrar"></a></td>

            <td>
                <div>
                    <form action="{% url 'employer_default_portal' %}" method="delete">
                        {% csrf_token %}
                        <input type="submit" value="Delete" placeholder="Delete" />
                    </form>
                </div>
            </td>
        </tr>
        {% endif %}
    </table>
</div>
{% endblock %}